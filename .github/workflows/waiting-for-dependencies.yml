name: Checking for dependencies updates

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
    check-dependencies:
        name: Checking package.json files
        runs-on: ubuntu-latest
        permissions:
          pull-requests: write
        steps:
            - name: checkout
              uses: actions/checkout@v4
            - name: Check dependencies
              uses: ./.github/actions/check-dependencies-in-progress/
              id: check-dependencies
            - name: Get the output time
              run: echo "The time was ${{ steps.check-dependencies.outputs.has-dependency-in-progress }}"
            - run: gh pr edit ${{ github.event.pull_request.number }} --add-label "Waiting For Dependency Update"
              if: steps.check-dependencies.outputs.has-dependency-in-progress == 'true'
              env:
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                GH_REPO: ${{ github.repository }}
            - run: gh pr edit ${{ github.event.pull_request.number }} --remove-label "Waiting For Dependency Update"
              if: steps.check-dependencies.outputs.has-dependency-in-progress == 'false'
              env:
                GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
                GH_REPO: ${{ github.repository }}
